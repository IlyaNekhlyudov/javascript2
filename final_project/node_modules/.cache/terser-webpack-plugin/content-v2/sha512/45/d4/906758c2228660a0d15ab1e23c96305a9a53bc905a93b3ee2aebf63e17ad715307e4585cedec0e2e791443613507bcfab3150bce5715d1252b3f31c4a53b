{"code":"!function(n){var e={};function t(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=n,t.c=e,t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:r})},t.r=function(n){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(n,\"__esModule\",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&\"object\"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:n}),2&e&&\"string\"!=typeof n)for(var o in n)t.d(r,o,function(e){return n[e]}.bind(null,o));return r},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,\"a\",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p=\"/\",t(t.s=2)}([function(n,e){n.exports=require(\"fs\")},function(n,e){n.exports=require(\"express\")},function(n,e,t){var r=t(1),o=t(0),u=t(3),i=r(),s=t(7),d=t(10);i.use(r.json()),i.use(\"/\",r.static(\"./public\")),i.use(\"/api/cart\",u),i.use(\"/api/order\",s),i.use(\"/api/email\",d),i.get(\"/api/products\",(function(n,e){o.readFile(\"./server/db/products.json\",\"utf-8\",(function(n,t){n?e.sendStatus(404,JSON.stringify({result:0,text:n})):e.send(t)}))}));var a=process.env.PORT||8888;i.listen(a,(function(){console.log(\"Listening \".concat(a,\" port\"))}))},function(n,e,t){var r=t(1),o=t(0),u=t(4),i=r.Router();i.get(\"/\",(function(n,e){o.readFile(\"./server/db/userCart.json\",\"utf-8\",(function(n,t){n?e.sendStatus(404,JSON.stringify({result:0,text:n})):e.send(t)}))})),i.post(\"/\",(function(n,e){u(n,e,\"add\",\"./server/db/userCart.json\")})),i.put(\"/:id\",(function(n,e){u(n,e,\"change\",\"./server/db/userCart.json\")})),i.put(\"/order/:id\",(function(n,e){u(n,e,\"changeOrd\",\"./server/db/userCart.json\")})),i.delete(\"/:id\",(function(n,e){u(n,e,\"del\",\"./server/db/userCart.json\")})),i.delete(\"/del/all\",(function(n,e){u(n,e,\"delOrd\",\"./server/db/userCart.json\")})),n.exports=i},function(n,e,t){var r=t(0),o=t(5),u=t(6),i={add:o.add,change:o.change,changeOrd:o.changeOrd,del:o.del,delOrd:o.delOrd};n.exports=function(n,e,t,o){r.readFile(o,\"utf-8\",(function(s,d){if(s)e.sendStatus(404,JSON.stringify({result:0,text:s}));else{var a=i[t](JSON.parse(d),n),c=a.name,f=a.newCart;r.writeFile(o,f,(function(n){n?e.send('{\"result\": 0}'):(u(c,t),e.send('{\"result\": 1}'))}))}}))}},function(n,e){n.exports={add:function(n,e){return n.contents.push(e.body),n.amount+=e.body.price,n.countGoods+=1,{name:e.body.name,newCart:JSON.stringify(n,null,4)}},change:function(n,e){var t=n.contents.find((function(n){return n.id===+e.params.id}));return t.quantity+=+e.body.quantity,e.body.quantity<0?(n.amount-=+t.price,n.countGoods-=1):(n.amount+=+t.price,n.countGoods+=1),{name:e.body.name,newCart:JSON.stringify(n,null,4)}},changeOrd:function(n,e){return n.contents.find((function(n){return n.id===+e.params.id})).quantity=+e.body.quantity,n.amount=0,n.countGoods=0,0!==n.contents.length&&n.contents.forEach((function(e){n.countGoods+=1*e.quantity,n.amount+=e.price*e.quantity})),{name:e.body.name,newCart:JSON.stringify(n,null,4)}},del:function(n,e){var t=n.contents.find((function(n){return n.id===+e.params.id}));return n.contents.splice(n.contents.indexOf(t),1),n.amount=0,n.countGoods=0,0!==n.contents.length&&n.contents.forEach((function(e){n.countGoods+=1*e.quantity,n.amount+=e.price*e.quantity})),{name:e.body.name,newCart:JSON.stringify(n,null,4)}},delOrd:function(n,e){return n.contents.length=0,n.amount=0,n.countGoods=0,{name:e.body.name,newCart:JSON.stringify(n,null,4)}}}},function(n,e,t){var r=t(0);n.exports=function(n,e){r.readFile(\"./server/db/stats.json\",\"utf-8\",(function(t,o){if(t)console.log(t);else{var u=JSON.parse(o);u.push({date:new Date,product_name:n,action:e}),r.writeFile(\"./server/db/stats.json\",JSON.stringify(u,null,4),(function(n){n&&console.log(n)}))}}))}},function(n,e,t){var r=t(1),o=(t(0),t(8)),u=r.Router();u.post(\"/\",(function(n,e){o(n,e,\"add\",\"./server/db/orders.json\")})),n.exports=u},function(n,e,t){var r=t(0),o={add:t(9).add};n.exports=function(n,e,t,u){r.readFile(u,\"utf-8\",(function(i,s){if(i)e.sendStatus(404,JSON.stringify({result:0,text:i}));else{var d=o[t](JSON.parse(s),n),a=(d.name,d.newOrder);r.writeFile(u,a,(function(n){n?e.send('{\"result\": 0}'):e.send('{\"result\": 1}')}))}}))}},function(n,e){n.exports={add:function(n,e){return n.contents.push(e.body),{name:e.body.order_name,newOrder:JSON.stringify(n,null,4)}}}},function(n,e,t){var r=t(1),o=t(0),u=t(11),i=r.Router();i.get(\"/\",(function(n,e){o.readFile(\"./server/db/email.json\",\"utf-8\",(function(n,t){n?e.sendStatus(404,JSON.stringify({result:0,text:n})):e.send(t)}))})),i.post(\"/\",(function(n,e){u(n,e,\"add\",\"./server/db/email.json\")})),i.put(\"/:id\",(function(n,e){u(n,e,\"change\",\"./server/db/email.json\")})),i.delete(\"/:id\",(function(n,e){u(n,e,\"del\",\"./server/db/email.json\")})),n.exports=i},function(n,e,t){var r=t(0),o=t(12),u={add:o.add,del:o.del};n.exports=function(n,e,t,o){r.readFile(o,\"utf-8\",(function(i,s){if(i)e.sendStatus(404,JSON.stringify({result:0,text:i}));else{var d=u[t](JSON.parse(s),n).newEmail;r.writeFile(o,d,(function(n){n?e.send('{\"result\": 0}'):e.send('{\"result\": 1}')}))}}))}},function(n,e){n.exports={add:function(n,e){return n.list.push(e.body),{newEmail:JSON.stringify(n,null,4)}},del:function(n,e){return n.list.splice(n.list.indexOf(e.body.email),1),{newEmail:JSON.stringify(n,null,4)}}}}]);","extractedComments":[]}